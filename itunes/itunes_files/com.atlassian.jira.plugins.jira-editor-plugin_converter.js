;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/node-handler.js' */
define("jira/editor/converter/handlers/node-handler",["jira/editor/converter/util/strings","jira/editor/converter/util/rte-strings","jira/editor/converter/new-lines/new-lines","jira/lib/class","underscore","jquery"],function(d,c,a,b,i,e){var g={};var j=[];var h=b.extend({init:function h(k){this.node=k},before:function(){return new h.EmptyHandler()},processText:function(){return""},after:function(){return new h.EmptyHandler()},children:function(){var k=[];var m=this.node.childNodes;var l=i.filter(m,function(o,n){var p=this.createChildHandler(o,n,m.length);if(p.processText()===""){return true}if(c.isWhitespace(p.processText())&&d.contains(p.processText(),"\n")&&!p.preformatted){return false}return true},this);i.each(l,function(o,n){k.push(this.createBeforeChild(o,n,l.length));k.push(this.createChildHandler(o,n,l.length));k.push(this.createAfterChild(o,n,l.length))},this);return k},createBeforeChild:function(l,m,k){return new h.EmptyHandler()},createAfterChild:function(l,m,k){return new h.EmptyHandler()},createChildHandler:function(l,m,k){return h.createHandler(l)},newLinesBefore:function(){var k=h._isBlock(this.node.parentNode)||e(this.node).parents().is("th, td");if(h._isBlock(this.node)&&!(e(this.node).is(":first-child")&&k)){return a.single(true)}else{return a.empty()}},newLinesAfter:function(){return a.empty()}});h.EmptyHandler=h.extend({init:function f(k){this.node=k},before:function(){throw undefined},after:function(){throw undefined},processText:function(){return""},children:function(){return[]}});h.addHandler=function(k,l){k=k.toLowerCase();g[k]=l;j.push(k)};h.getHandler=function(k){var l=k.nodeName.toLowerCase();return g[(l+"."+(k.className||"")).toLowerCase()]||g[l]||j.reduce(function(n,m){return n||e(k).is(m)&&g[m]},null)||h};h.createHandler=function(k){return new (h.getHandler(k))(k)};h.isInsideTable=function(k){return e(k).parents("td").length>0||e(k).parents("th").length>0};h.singleNewLineExceptTable=function(l,k){if(h.isInsideTable(l)){return a.empty()}return a.single(k)};h._isBlock=i.memoize(function(l){if(!l||!l.tagName){return false}var k=document.createElement(l.tagName);document.body.appendChild(k);try{return window.getComputedStyle(k).display==="block"}finally{document.body.removeChild(k)}},function(k){if(!k||!k.tagName){return""}return k.tagName});h.isEmptyTextNode=function(k){if(!k){return false}return k.nodeType===Node.TEXT_NODE&&c.trim(k.nodeValue)===""};return h});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/empty-handler.js' */
define("jira/editor/converter/handlers/empty-handler",["jira/editor/converter/handlers/node-handler"],function(a){return a.EmptyHandler});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/block-handler.js' */
define("jira/editor/converter/handlers/block-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/new-lines/new-lines","jira/editor/converter/util/strings","jira/editor/converter/util/color-converter","jquery"],function(d,h,c,g,b,f){var a=d.extend({init:function a(i){this.wrapperNode=i;this.node=i.querySelector(".panelContent")||i;this.nodeHeader=i.querySelector("panel-title")||i.querySelector(".panelHeader");this.attrs=this.getAttrs();if(f(this.node).is(".panelContent")){this.workaroundTypingOutsideWrapper()}},workaroundTypingOutsideWrapper:function(){var i=f(this.wrapperNode);i.find("> p").before('<br data-mce-bogus="1">');if(this.node){var j=i.find("> :not(div.preformattedContent.panelContent, div.codeContent.panelContent, div.panelHeader, div.panelContent)");j.detach().appendTo(this.node)}else{this.node=this.wrapperNode}},getAttrs:function(){var i=[];if(this.nodeHeader){if(this.nodeHeader.textContent){i.push("title="+this.nodeHeader.textContent)}if(this.nodeHeader.style.borderBottomStyle){i.push("borderStyle="+this.nodeHeader.style.borderBottomStyle)}if(this.nodeHeader.style.borderBottomWidth&&this.nodeHeader.style.borderBottomWidth!=="1px"){i.push("borderWidth="+this.nodeHeader.style.borderBottomWidth)}if(this.nodeHeader.style.borderBottomColor){i.push("borderColor="+b.colorToHex(this.nodeHeader.style.borderBottomColor))}if(this.nodeHeader.style.backgroundColor){i.push("titleBGColor="+b.colorToHex(this.nodeHeader.style.backgroundColor))}}if(this.wrapperNode){if(this.wrapperNode.style.backgroundColor){i.push("bgColor="+b.colorToHex(this.wrapperNode.style.backgroundColor))}}return i.length>0?i.join("|"):""},createChildHandler:function(k,l,j){if(k.nodeType===Node.TEXT_NODE){return h.createPreformattedTextHandler(k)}else{if(k.tagName==="BR"){return h.newlineHandler()}else{if(k.tagName==="IMG"){if(!g.startsWith(k.src,"data")&&!g.startsWith(k.src,"blob")){return d.createHandler(k)}else{var i=document.createTextNode("(attachment)");return h.createTextHandler(i)}}else{if(k.tagName==="PRE"){return new e(k)}else{if(k.tagName==="PANEL-TITLE"){return new d.EmptyHandler(k)}else{return new e(k)}}}}}},children:function(){var i=d.prototype.children.apply(this,arguments);i.unshift(c.single(true));return i},newLinesBefore:function(){return d.singleNewLineExceptTable(this.wrapperNode,true)},newLinesAfter:function(){return d.singleNewLineExceptTable(this.wrapperNode,true)}});var e=d.extend({createChildHandler:a.prototype.createChildHandler,newLinesBefore:function(){return c.empty()},before:function(){return new d.EmptyHandler()},after:function(){return new d.EmptyHandler()}});return a});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/text-handler.js' */
define("jira/editor/converter/handlers/text-handler",["jira/featureflags/feature-manager","jira/editor/converter/util/strings","jira/editor/converter/util/rte-strings","jira/editor/converter/handlers/node-handler","jira/editor/context-detector"],function(b,f,a,d,c){var e=d.extend({init:function e(g){this.node=g;this.preformatted=this.node.preformatted},processText:function(){var h=this.node.textContent||"";if(this.node.preformatted){return h}if(!a.isWhitespace(h)){h=this.trimNewlines(h)}var g=h;if(b.isFeatureEnabled("jira.renderer.consider.variable.format")){g=g.replace(/([^$])({[^}]+})/g,"$1\\$2").replace(/(\$)({[^}]+)$/g,"$1\\$2")}else{g=g.replace(/{/g,"\\{")}if(c.detectTable(this.node)){g=f.replace(g,"|","\\|")}return g},children:function(){return[]},trimNewlines:function(n){var k;for(k=0;k<n.length;k++){if(!a.isWhitespace(n[k])){break}}var h;for(h=n.length-1;h>=0;h--){if(!a.isWhitespace(n[h])){break}}var l=n.substring(0,k);var m=n.substring(k,h+1);var g=n.substring(h+1);return f.replace(l,"\n","")+m+f.replace(g,"\n","")}});e.createTextHandler=function(g){var h=g;if(g instanceof Node){h=g.textContent}return new e({textContent:h||""})};e.createPreformattedTextHandler=function(g){var h=g;if(g instanceof Node){h=g.textContent}return new e({textContent:h||"",preformatted:true})};e.newlineHandler=function(){return new e({textContent:"\n",preformatted:true})};return e});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/heading-handler.js' */
define("jira/editor/converter/handlers/heading-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/handlers/empty-handler"],function(b,d,a){var e=b.extend({init:function e(f){this.node=f},newLinesBefore:function(){return b.singleNewLineExceptTable(this.node,true)},before:function(){var f=this.node.tagName;if(f in c){return d.createTextHandler(c[f])}return new a()},newLinesAfter:function(){return b.singleNewLineExceptTable(this.node)}});var c={};c.H1="h1. ";c.H2="h2. ";c.H3="h3. ";c.H4="h4. ";c.H5="h5. ";c.H6="h6. ";return e});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/bold-handler.js' */
define("jira/editor/converter/handlers/bold-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/factories/whitespace-extractor"],function(b,d,e){var c=b.extend({init:function a(f){this.node=f},before:function(){return d.createTextHandler("*")},after:function(){return d.createTextHandler("*")}});return e(c)});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/emphasis-handler.js' */
define("jira/editor/converter/handlers/emphasis-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/factories/whitespace-extractor"],function(a,c,d){var b=a.extend({init:function e(f){this.node=f},before:function(){return c.createTextHandler("_")},after:function(){return c.createTextHandler("_")}});return d(b)});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/monospaced-handler.js' */
define("jira/editor/converter/handlers/monospaced-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/factories/whitespace-extractor"],function(a,c){var b=a.extend({init:function d(e){this.node=e},before:function(){return c.createPreformattedTextHandler("{{")},after:function(){return c.createPreformattedTextHandler("}}")}});return b});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/link-handler.js' */
define("jira/editor/converter/handlers/link-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/handlers/image-handler","jira/editor/converter/handlers/empty-handler","jira/editor/converter/handlers/superscript-handler","jira/editor/converter/util/strings","jira/editor/converter/util/uri","jquery"],function(i,a,h,g,b,e,c,f){var d=i.extend({init:function(m){this.node=m;var l=this.node.getAttribute("href");var k=e.resolveUrl(l,e.getBaseUrl());var j=m.getAttribute("data-filename");if(d.isAnchor(l)){k=l}else{if(d.isAttachment(k)||j){this.attachment=j||e.getFilenameFromHref(k);if(f(m).find(">:first-child:last-child").is("img")){this.imageAttachment=this.attachment}}else{if(d.isIssue(k)){this.issueKey=e.substringAfter(k,e.getContextUrl()+"/browse/")}else{if(d.isProfile(k,m)){this.username=c.decodeUri(e.substringAfter(k,"ViewProfile.jspa?name="))}else{if(d.isWiki(k,m)){this.wikiLink=f(m).text()}}}}}this.href=k},before:function(){var j=f(this.node.previousSibling).is("a")?" ":"";if(this.imageAttachment){return a.createTextHandler(j+"!")}else{if(this.attachment){return a.createTextHandler(j+"[^")}else{if(this.issueKey){return new g()}else{if(this.username){return a.createTextHandler(j+"[~")}else{if(this.href||this.wikiLink){return a.createTextHandler(j+"[")}else{return new g()}}}}}},children:function(){if(this.imageAttachment){return[a.createTextHandler(""+this.imageAttachment)]}else{if(this.attachment){return[a.createTextHandler(""+this.attachment)]}else{if(this.username){return[a.createTextHandler(""+this.username)]}else{if(d.isAnchor(this.href,this.node)){return a.createTextHandler(this.href)}else{if(d.isMailto(this.href,this.node)){return this._filterMailtoChildren(this._super())}else{return this._super()}}}}}},after:function(){if(this.imageAttachment){var j=h.getAttrs(f(this.node).find("> img")[0]);return a.createTextHandler(j+"!")}else{if(this.attachment||this.wikiLink){return a.createTextHandler("]")}else{if(this.issueKey){return new g()}else{if(this.username){return a.createTextHandler("]")}else{if(this.href){if(this.href===f(this.node).text()||d.isAnchor(this.href,this.node)){return a.createTextHandler("]")}else{return a.createTextHandler("|"+this.href+"]")}}else{return new g()}}}}}},_filterMailtoChildren:function(j){if(j.length>=3&&(j[j.length-2] instanceof b)){j=j.splice(0,j.length-3)}return j}});d.isAttachment=function(j){if(/^\//.test(j)){j=window.location.origin+j}return e.startsWith(j,e.getContextUrl()+"/secure/attachment/")||e.startsWith(j,"../secure/attachment/")};d.isIssue=function(j){if(/^\//.test(j)){j=window.location.origin+j}return e.startsWith(j,e.getContextUrl()+"/browse/")};d.isProfile=function(j,k){return e.contains(j,"ViewProfile.jspa?name=")&&f(k).is(".user-hover")};d.isWiki=function(j,k){return e.contains(j,"/wiki/display/")&&e.endsWith(c.decodeUri(j),"/"+f(k).text())};d.isMailto=function(j,k){return e.startsWith(j,"mailto:")};d.isAnchor=function(j,k){return e.startsWith(j,"#")&&(!k||j===("#"+f(k).text()))};return d});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/linebreak-handler.js' */
define("jira/editor/converter/handlers/linebreak-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jquery"],function(a,c,b){return a.extend({init:function d(e){this.node=e},before:function(){return new a.EmptyHandler()},children:function(){return new a.EmptyHandler()},after:function(){if(!this.node.previousSibling&&!this.node.nextSibling&&b(this.node).parent().is("td, th")){return c.createTextHandler(" ")}else{if(this.node.previousSibling&&this.node.previousSibling.tagName==="BR"&&b(this.node).parent().is("td, th")){return new c({textContent:decodeURI("%C2%A0")+"\n",preformatted:true})}else{return c.newlineHandler()}}}})});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/image-handler.js' */
define("jira/editor/converter/handlers/image-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/handlers/empty-handler","jquery","jira/editor/converter/util/strings","wrm/context-path"],function(j,a,f,c,b,d){var k="/images/icons/";var h="/images/icons/emoticons/";var g={EMOTE:"emote",EXTERNAL:"external-image",ATTACHMENT:"attachment-image",TEMPORARY_ATTACHMENT:"temporary-attachment-image",PLACEHOLDER:"placeholder"};var i=j.extend({init:function i(l){this.node=l;this.imageType=this._getImageType(l)},_getImageType:function(l){if(this.node.getAttribute("imagetext")){return g.PLACEHOLDER}var m=this.node.getAttribute("data-image-type");if(m){return m}var n=this.node.getAttribute("src");if(b.isEmotePath(n)&&l.classList.contains("emoticon")){if(b.contains(n,k+"mail_small")&&this.$(l).parents("a").is(".external-link")){return}return g.EMOTE}if(b.isAttachmentPath(n)||b.isThumbnailPath(n)||n.match(/^((data|blob):http)|(data:image)/)){return g.ATTACHMENT}if(b.isTemporaryAttachmentPath(n)){return g.TEMPORARY_ATTACHMENT}return g.EXTERNAL},before:function(){var m=this.node.previousSibling;var l=(m&&m.nodeType===Node.TEXT_NODE&&!b.endsWith(m.textContent," "))?" ":"";if(this.imageType&&this.imageType!==g.EMOTE){return a.createTextHandler(l+"!")}return new f()},children:function(){return this.imageType?a.createTextHandler(this._getImageSource()):new f()},after:function(){var m=this.node.nextSibling;var l=(m&&m.nodeType===Node.TEXT_NODE&&!b.startsWith(m.textContent," "))?" ":"";if(this.imageType&&this.imageType!==g.EMOTE){return a.createTextHandler("!"+l)}return new f()},_getImageSource:function(){if(this.imageType===g.PLACEHOLDER){return this.node.getAttribute("imagetext")}else{if(this.imageType===g.EMOTE){var l=this.node.getAttribute("src");var m=b.substringAfter(l,h).replace(/\.(png|gif)$/,"");if(m in e){return e[m]}if(b.startsWith(l,d())){return"!"+document.location.origin+l+"!"}}else{if(this.imageType===g.ATTACHMENT||this.imageType===g.TEMPORARY_ATTACHMENT||this.imageType===g.EXTERNAL){var o=this.node.getAttribute("data-filename")||this.node.getAttribute("href")||this.node.getAttribute("src");if(this.imageType===g.ATTACHMENT){o=b.getFilenameFromHref(o)}else{if(this.imageType===g.TEMPORARY_ATTACHMENT&&!this.node.getAttribute("data-filename")){o=b.getFilenameFromHref(o,true)}}var n=i.getAttrs(this.node);if(n){return o+n}return o}}}}});i.getAttrs=function(m){if(c(m).is("img.emoticon")){return""}var l=[];if(m.width){l.push("width="+m.width)}if(m.height){l.push("height="+m.height)}if(m.id){l.push("id="+m.id)}if(m.vspace){l.push("vspace="+m.vspace)}if(m.align){l.push("align="+m.align)}else{if(m.style.textAlign){l.push("align="+m.style.textAlign)}else{if(m.style["float"]){l.push("align="+m.style["float"])}}}if(b.isThumbnailPath(m.getAttribute("src"))){l.push("thumbnail")}return l.length>0?"|"+l.join(","):""};var e={smile:":)",sad:":(",tongue:":P",biggrin:":D",wink:";)",thumbs_up:"(y)",thumbs_down:"(n)",information:"(i)",check:"(/)",error:"(x)",warning:"(!)",add:"(+)",forbidden:"(-)",help_16:"(?)",lightbulb_on:"(on)",lightbulb:"(off)",star_yellow:"(*)",star_red:"(*r)",star_green:"(*g)",star_blue:"(*b)",flag:"(flag)",flag_grey:"(flagoff)"};return i});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/code-block-handler.js' */
define("jira/editor/converter/handlers/code-block-handler",["jira/editor/converter/handlers/block-handler","jira/editor/converter/handlers/text-handler","jquery"],function(a,d,c){var b=a.extend({init:function b(f){this._super(f);this.language=this.getLanguage()},getLanguage:function(){var f=c(this.node).is("pre")?this.node:this.node.querySelector("pre");var g=c(f).attr("data-language")||(f&&f.className);return(g in e)?e[g]:""},before:function(){var f=[];if(this.language){f.push(this.language)}if(this.attrs){f.push(this.attrs)}var f=(f.length)?":"+f.join("|"):"";return d.createPreformattedTextHandler("{code"+f+"}")},after:function(){return d.createPreformattedTextHandler("{code}")}});var e={"code-actionscript":"actionscript","code-java":"java","code-javascript":"javascript","code-sql":"sql","code-xml":"xml","code-none":"none"};return b});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/noformat-handler.js' */
define("jira/editor/converter/handlers/noformat-handler",["jira/editor/converter/handlers/block-handler","jira/editor/converter/handlers/text-handler"],function(a,c){var b=a.extend({before:function(){var d=this.attrs?":"+this.attrs:"";return c.createPreformattedTextHandler("{noformat"+d+"}")},after:function(){return c.createPreformattedTextHandler("{noformat}")}});return b});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/list-type-matcher.js' */
define("jira/editor/converter/handlers/list-type-matcher",["jquery","underscore"],function(b,a){var c={};c.selectorBulletMap={};c.selectorBulletMap["ul:not(.alternate)"]="*";c.selectorBulletMap["ul.alternate"]="-";c.selectorBulletMap.ol="#";c.DEFAULT_DECORATOR="*";c.matchBullet=function(d){return a.find(c.selectorBulletMap,function(f,e){return b(d).is(e)})};c.getBulletDecorator=function(d){return c.matchBullet(d)||c.DEFAULT_DECORATOR};c.isListNode=function(d){return c.matchBullet(d)!=null};return c});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/list-handler.js' */
define("jira/editor/converter/handlers/list-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/handlers/empty-handler","jira/editor/converter/handlers/list-type-matcher","jquery","jira/editor/converter/new-lines/new-lines","jira/editor/context-detector"],function(d,f,a,h,e,c,b){return d.extend({init:function g(i,j){this.node=i;this.type=this.node.getAttribute("type");if(typeof j==="undefined"){this.depth=0}else{this.depth=j}this.bulletDecorator=h.getBulletDecorator(i)},createChildHandler:function(j){var i=d.getHandler(j);if(j.tagName==="LI"){return new i(j,this.depth,this.bulletDecorator)}else{return new i(j)}},before:function(){return new a()},newLinesBefore:function(){if(this.depth===0&&b.detectTable(this.node)&&this.node.previousSibling&&!d.isEmptyTextNode(this.node.previousSibling)){return c.single(true)}return c.empty()},newLinesAfter:function(){if(this.depth===0&&!e(this.node).is(":last-child")){return new c(2,true)}return c.empty()},createAfterChild:function(j,k,i){if(k!==i-1){return f.newlineHandler()}return new a()}})});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/list-item-handler.js' */
define("jira/editor/converter/handlers/list-item-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/handlers/empty-handler","jira/editor/converter/handlers/list-type-matcher","jira/editor/converter/util/strings"],function(c,e,a,f,d){return c.extend({init:function b(g,i,h){this.node=g;if(typeof i==="undefined"){this.depth=0}else{this.depth=i}this.bulletDecorator=h},before:function(){var g=d.repeat(this.bulletDecorator,this.depth+1);return e.createTextHandler(" "+g+" ")},after:function(){return new a()},createBeforeChild:function(h,i,g){if(f.isListNode(h)){return e.newlineHandler()}return new a()},createChildHandler:function(i,j,h){var g=c.getHandler(i);if(f.isListNode(i)){return new g(i,this.depth+1)}else{return new g(i)}}})});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/table-handler.js' */
define("jira/editor/converter/handlers/table-handler",["jira/editor/converter/handlers/node-handler","jira/editor/context-detector","jira/editor/converter/new-lines/new-lines"],function(d,c,b){return d.extend({init:function a(e){this.node=e},newLinesBefore:function(){var e=c.detectTable(this.node.previousElementSibling);return b.single(!e)}})});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/table-row-handler.js' */
define("jira/editor/converter/handlers/table-row-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/handlers/empty-handler","jira/editor/converter/new-lines/new-lines"],function(c,e,a,b){return c.extend({init:function d(f){this.node=f},createBeforeChild:function(g,h,f){if(g.tagName==="TH"){return e.createTextHandler("||")}else{return e.createTextHandler("|")}},newLinesAfter:function(){return b.single()},createAfterChild:function(g,h,f){if(h===f-1){if(g.tagName==="TH"){return e.createTextHandler("||")}else{return e.createTextHandler("|")}}return new a()}})});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/table-data-handler.js' */
define("jira/editor/converter/handlers/table-data-handler",["jira/editor/converter/handlers/node-handler"],function(b){return b.extend({init:function a(c){this.node=c}})});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/paragraph-handler.js' */
define("jira/editor/converter/handlers/paragraph-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/empty-handler","jira/editor/converter/new-lines/new-lines","jquery"],function(d,b,c,e){return d.extend({init:function a(f){this.node=f},newLinesBefore:function(){if(this.node.previousElementSibling===null&&e(this.node).parents().is("td, th, .panelContent, .panel")){return c.empty()}if(this.node.previousElementSibling!==null){return c.single()}return c.empty()},newLinesAfter:function(){if(e(this.node).is(":last-child")&&e(this.node).parents().is("td, th")){return c.empty()}return c.single(e(this.node).parents().is("td, th"))},before:function(){return new b()}})});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/quote-handler.js' */
define("jira/editor/converter/handlers/quote-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler"],function(a,c){return a.extend({init:function b(d){this.node=d},before:function(){return c.createPreformattedTextHandler("{quote}")},after:function(){return c.createPreformattedTextHandler("{quote}")}})});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/panel-handler.js' */
define("jira/editor/converter/handlers/panel-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/handlers/block-handler"],function(b,c,a){return a.extend({init:function d(e){if(e.firstChild&&e.className===e.firstChild.className){e=e.firstChild}this.node=e;this._super(e)},before:function(){var e=this.attrs?":"+this.attrs:"";return c.createPreformattedTextHandler("{panel"+e+"}")},createChildHandler:function(){return b.prototype.createChildHandler.apply(this,arguments)},after:function(){return c.createPreformattedTextHandler("{panel}")}})});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/span-handler.js' */
define("jira/editor/converter/handlers/span-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/handlers/empty-handler","jira/editor/converter/util/strings","jira/editor/converter/util/color-converter","jquery"],function(d,g,a,f,b,e){var h=d.extend({init:function h(j){this.node=j;this.$node=e(this.node);var i=this.node.getAttribute("href");if(this.getStyle(this.node,"textDecoration")==="underline"){this.decorator="underline"}else{if(this.node.className==="error"){var l=this.$node.text();if(f.getFilenameFromError(l)){this.decorator="attachment-error"}}else{if(f.length(this.getStyle(this.node,"color"))>0){var k=this.getStyle(this.node,"color").toLowerCase();if(f.contains(k,"rgb")){this.color=b.colorToHex(k)}else{if(f.contains(k,"#")){this.color=k}else{if(k in c){this.color=c[k.toLowerCase()]}}}if(this.color!==undefined){this.decorator="color"}}else{if(this.node.className==="jira-issue-macro"&&this.$node.attr("data-jira-key")){this.decorator="jira-issue-macro"}}}}},before:function(){if(this.decorator==="attachment-error"){return g.createTextHandler("!")}else{if(this.decorator==="underline"){return g.createTextHandler("+")}else{if(this.decorator==="color"){return g.createPreformattedTextHandler("{color:"+this.color+"}")}}}return new a()},after:function(){if(this.decorator==="attachment-error"){return g.createTextHandler("!")}else{if(this.decorator==="underline"){return g.createTextHandler("+")}else{if(this.decorator==="color"){return g.createPreformattedTextHandler("{color}")}}}return new a()},children:function(){if(this.decorator==="attachment-error"){var i=f.getFilenameFromError(this.$node.text());return[g.createTextHandler(i)]}else{if(this.decorator==="jira-issue-macro"){return g.createTextHandler(this.$node.attr("data-jira-key"))}else{return this._super()}}},getStyle:function(j,i){if(i in this.node.style){return this.node.style[i]}return undefined}});var c={white:"#FFFFFF",silver:"#C0C0C0",gray:"#808080",black:"#000000",red:"#FF0000",maroon:"#800000",yellow:"#FFFF00",olive:"#808000",lime:"#00FF00",green:"#008000",aqua:"#00FFFF",teal:"#008080",blue:"#0000FF",navy:"#000080",purple:"#800080",orange:"#FFA500",brown:"#AA4B00",mahogany:"#C04000",pink:"#FFC0CB","yellow orche":"#CF912A",harlequin:"#3FFF00",mauvelous:"#EF98AA","dark red":"#8B0000",saffron:"#F4C430",sepia:"#704214",fuchsia:"#FF00FF",magenta:"#FF00FF",marsala:"#955251",indigo:"#000080"};return h});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/strikethrough-handler.js' */
define("jira/editor/converter/handlers/strikethrough-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/handlers/link-handler","jira/editor/converter/handlers/empty-handler","jira/editor/converter/factories/whitespace-extractor","jquery"],function(c,g,e,a,h,f){var d=c.extend({init:function b(i){this.node=i;if(f(i.parentNode).is("a[data-issue-key]")){this.isIssue=e.isIssue(f(i.parentNode).attr("href"))}},before:function(){return this.isIssue?new a():g.createTextHandler("-")},after:function(){return this.isIssue?new a():g.createTextHandler("-")}});return h(d)});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/superscript-handler.js' */
define("jira/editor/converter/handlers/superscript-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/handlers/empty-handler","jira/editor/converter/util/strings","jira/editor/converter/factories/whitespace-extractor","jquery"],function(b,g,a,f,h,e){var c=b.extend({init:function d(i){this.node=i;if(e(this.node).parents("a").is(".external-link")&&f.endsWith(e(this.node).children().attr("src"),"images/icons/mail_small.gif")){this.dontExpand=true}},before:function(){return this.dontExpand?new a():g.createTextHandler("^")},after:function(){return this.dontExpand?new a():g.createTextHandler("^")}});return h(c)});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/subscript-handler.js' */
define("jira/editor/converter/handlers/subscript-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/factories/whitespace-extractor"],function(b,d,e){var c=b.extend({init:function a(f){this.node=f},before:function(){return d.createTextHandler("~")},after:function(){return d.createTextHandler("~")}});return e(c)});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/underline-handler.js' */
define("jira/editor/converter/handlers/underline-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/factories/whitespace-extractor"],function(b,d,e){var c=b.extend({init:function a(f){this.node=f},before:function(){return d.createTextHandler("+")},after:function(){return d.createTextHandler("+")}});return e(c)});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/hr-handler.js' */
define("jira/editor/converter/handlers/hr-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/handlers/empty-handler"],function(b,c,a){return b.extend({init:function d(e){this.node=e},before:function(){return new a()},children:function(){var e=new c({textContent:"----",preformatted:true});return[e]},after:function(){return new a()}})});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/cite-handler.js' */
define("jira/editor/converter/handlers/cite-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler"],function(a,c){return a.extend({init:function b(d){this.node=d},before:function(){return c.createTextHandler("??")},after:function(){return c.createTextHandler("??")}})});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/external-handler.js' */
define("jira/editor/converter/handlers/external-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/new-lines/new-lines","jira/editor/converter","underscore"],function(d,f,c,e,b){var a=d.extend({init:function(g){this.node=g},children:function(){var g=this.external(this.getParams());return[f.createPreformattedTextHandler(g)]},getParams:function(){return Object.create(Object.prototype,{node:{value:this.node},innerMarkup:{get:function(){return e.handleMarkup(this.node.innerHTML)}}})}});a.forConverter=function(g){var h=AJS.namespace(g["function"]);if(!b.isFunction(h)){console.error(g["function"]," is not a function, this macro won't be supported by converter: ",g.selector," - it may result in data loss.");return}d.addHandler(g.selector,a.extend({external:h}))};a.Legacy=f.extend({init:function(g){this.node=g},processText:function(){var h=this.node.getAttribute("data-original-text");var g=this.node.getAttribute("data-command");return(h||"")+(this.node.innerText||this.node.textContent)+(g&&("{"+g+"}"))},newLinesBefore:function(){return this.node.getAttribute("data-new-line-before")==="true"?c.single(true):c.empty()},newLinesAfter:function(){return this.node.getAttribute("data-new-line-after")==="true"?c.single(true):c.empty()}});return a});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handler-mapper.js' */
define("jira/editor/converter/handler-mapper",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/handlers/heading-handler","jira/editor/converter/handlers/bold-handler","jira/editor/converter/handlers/emphasis-handler","jira/editor/converter/handlers/monospaced-handler","jira/editor/converter/handlers/linebreak-handler","jira/editor/converter/handlers/link-handler","jira/editor/converter/handlers/image-handler","jira/editor/converter/handlers/code-block-handler","jira/editor/converter/handlers/noformat-handler","jira/editor/converter/handlers/list-handler","jira/editor/converter/handlers/list-item-handler","jira/editor/converter/handlers/paragraph-handler","jira/editor/converter/handlers/strikethrough-handler","jira/editor/converter/handlers/superscript-handler","jira/editor/converter/handlers/subscript-handler","jira/editor/converter/handlers/underline-handler","jira/editor/converter/handlers/quote-handler","jira/editor/converter/handlers/panel-handler","jira/editor/converter/handlers/span-handler","jira/editor/converter/handlers/table-handler","jira/editor/converter/handlers/table-row-handler","jira/editor/converter/handlers/table-data-handler","jira/editor/converter/handlers/hr-handler","jira/editor/converter/handlers/cite-handler","jira/editor/wrm"],function(n,s,a,b,x,m,t,w,p,l,c,i,o,e,k,g,r,f,u,j,h,y,B,q,A,d,v){return{registerHandlers:function z(){var C=require("jira/editor/converter/handlers/external-handler");v.getConverters().forEach(C.forConverter);n.addHandler("pre.external-macro",C.Legacy);n.addHandler("H1",a);n.addHandler("H2",a);n.addHandler("H3",a);n.addHandler("H4",a);n.addHandler("H5",a);n.addHandler("H6",a);n.addHandler("A",w);n.addHandler("B",b);n.addHandler("STRONG",b);n.addHandler("BR",t);n.addHandler("EM",x);n.addHandler("I",x);n.addHandler("IMG",p);n.addHandler("TT",m);n.addHandler("CODE",m);n.addHandler("SAMP",m);n.addHandler("DIV.preformatted panel",c);n.addHandler("PRE.noformat panel",c);n.addHandler("DIV.code panel",l);n.addHandler("PRE.code panel",l);n.addHandler("PANEL-TITLE",n.EmptyHandler);n.addHandler("UL",i);n.addHandler("OL",i);n.addHandler("LI",o);n.addHandler("P",e);n.addHandler("DEL",k);n.addHandler("SUB",r);n.addHandler("SUP",g);n.addHandler("INS",f);n.addHandler("U",f);n.addHandler("TABLE",y);n.addHandler("TR",B);n.addHandler("CAPTION",B);n.addHandler("TD",q);n.addHandler("TH",q);n.addHandler("SPAN",h);n.addHandler("BLOCKQUOTE",u);n.addHandler("DIV.panel",j);n.addHandler("PRE.panel",j);n.addHandler("HR",A);n.addHandler("CITE",d);n.addHandler("#text",s)}}});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/factories/whitespace-extractor.js' */
define("jira/editor/converter/factories/whitespace-extractor",["jira/editor/constants","jira/editor/converter/handlers/text-handler","jira/editor/converter/factories/left-trim","jira/editor/converter/factories/right-trim"],function(c,f,b,e){return function a(n){return n.extend({init:function h(o){this._super(o);this.leftWhitespaces=g(o.firstChild,c.LEFT_WHITESPACE_MATCHER);this.rightWhitespaces=g(o.lastChild,c.RIGHT_WHITESPACE_MATCHER);this.leftTrimChildren=!!this.leftWhitespaces;this.rightTrimChildren=!!this.rightWhitespaces},before:function l(){var o=this._super();return this._extractLeftSpaces(o)||o},after:function m(){var o=this._super();return this._extractRightSpaces(o)||o},createChildHandler:function j(p,r,o){var q=this._super(p,r,o);if(this.leftTrimChildren&&0===r){q=b(q)}if(this.rightTrimChildren&&o-1===r){q=e(q)}return q},_extractLeftSpaces:function k(o){if(!this.leftTrimChildren){return null}var p=d(o);return p(this.leftWhitespaces+o.processText())},_extractRightSpaces:function i(o){if(!this.rightTrimChildren){return null}var p=d(o);return p(o.processText()+this.rightWhitespaces)}})};function g(k,j){var i=(k&&k.textContent)||"";var h=i.match(j);return(null!==h)?h[0]:null}function d(h){return(h.preformatted)?f.createPreformattedTextHandler:f.createTextHandler}});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/factories/left-trim.js' */
define("jira/editor/converter/factories/left-trim",["jira/editor/constants"],function(b){return function a(f){var d=Object.create(f);d.createChildHandler=function e(h,j,g){var i=Object.getPrototypeOf(d).createChildHandler.call(this,h,j,g);if(0===j){i=a(i)}return i};d.processText=function c(){return Object.getPrototypeOf(d).processText.call(this).replace(b.LEFT_WHITESPACE_MATCHER,"")};d._extractLeftSpaces=function(){};return d}});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/factories/right-trim.js' */
define("jira/editor/converter/factories/right-trim",["jira/editor/constants"],function(b){return function a(f){var e=Object.create(f);e.createChildHandler=function d(h,j,g){var i=Object.getPrototypeOf(e).createChildHandler.call(this,h,j,g);if(g-1===j){i=a(i)}return i};e.processText=function c(){return Object.getPrototypeOf(e).processText.call(this).replace(b.RIGHT_WHITESPACE_MATCHER,"")};e._extractRightSpaces=function(){};return e}});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/new-lines/new-lines.js' */
define("jira/editor/converter/new-lines/new-lines",["jira/lib/class"],function(a){var b=a.extend({init:function(c,d){this._lines=c;this._optional=d},newLines:function(){return this._lines},optional:function(){return this._optional}});b.empty=function(){return new b(0,true)};b.single=function(c){return new b(1,!!c)};return b});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/new-lines/new-lines-merger.js' */
define("jira/editor/converter/new-lines/new-lines-merger",["underscore","jira/editor/converter/util/strings","jira/editor/converter/new-lines/new-lines"],function(c,d,b){function a(f){var h=c.max(f.filter(function(i){return i.optional()}).map(function(i){return i.newLines()}));var g=f.filter(function(i){return !i.optional()}).reduce(function(i,j){return i+j.newLines()},0);return Math.max(g,h)}function e(f){f=c.filter(f,function(i){return i instanceof b||i!==""});var j=[];var k=[];for(var g=0;g<f.length;g++){var h=f[g];if(h instanceof b){j.push(h);continue}k.push(d.repeat("\n",a(j)));k.push(h);j=[]}return k}return{mergeNewLines:e,_newLinesNumber:a}});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/html-converter.js' */
define("jira/editor/converter",["jquery","jira/editor/converter/util/rte-strings","jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/empty-handler","jira/editor/converter/new-lines/new-lines","jira/editor/converter/new-lines/new-lines-merger","jira/editor/converter/handler-mapper","jira/editor/analytics","exports"],function(d,b,l,e,a,h,j,k,c){j.registerHandlers();var i=function(r){if(r==null){return""}var q=[l.createHandler(r)];var o=[];while(q.length!==0){var p=q.pop();if(p instanceof e){continue}if(p instanceof a){o.push(p);continue}q.push(p.newLinesBefore());q.push(p.before());var n=p.children();q=q.concat(n);q.push(p.after());o.push(p.processText());o.push(p.newLinesAfter())}o=h.mergeNewLines(o);var m=b.trim(o.reverse().join(""));return m};var g=function(m){return i(b.parseHtml(m))};var f=function(o){var n=new d.Deferred();k.mark("rte-convert");try{var r=b.parseHtml(o);var p=(r?r.getElementsByTagName("*").length:0);var m=i(r);n.resolve(m);k.oneShotMeasure("rte-convert",{nodesCount:p})}catch(q){n.reject(q);k.oneShotMeasure("rte-convert",{nodesCount:-1})}return n.promise()};c.handleMarkup=g;c.convert=f});;