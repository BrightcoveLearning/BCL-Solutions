;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:mentions-plugin', location = 'js/plugins/mentions/jira-mentions-plugin.js' */
define("jira/editor/plugins/mentions/jira-mentions",["jira/editor/tinymce","jquery","jira/editor/plugins/mentions/mention-rte","jira/editor/plugins/mentions/mentions-util"],function(e,f,b,h){var g=8;var d={9:"Tab",13:"Return",27:"Esc",38:"Up",40:"Down"};var a=function(i){var j=new f.Event("aui:keydown");j.key=d[i.which];j.shiftKey=i.shiftKey;j.ctrlKey=i.ctrlKey;j.altKey=i.altKey;j.target=i.target;arguments[0]=j;f.event.trigger(j,arguments,document,true)};var c=function(j,i){var l=i.$textarea.get(0).ownerDocument;i.mentioningInProgress=false;i.layerController.bind("showLayer",function(){i.mentioningInProgress=true}).bind("hideLayer",function(){i.mentioningInProgress=false});j.on("keydown",function k(n){var o=n.which in d&&i.mentioningInProgress===true;if(o){n.preventDefault();n.stopPropagation();a(n)}else{if(n.keyCode===g){if(h.isCaretAfterMention(l)){var m=h.getMentionBeforeCaret(l);h.selectMention(m,n,this)}}}},true)};e.create("tinymce.plugins.jira.JiraMentions",{init:function(i){var j=i.settings;if(j.jiramentions.mentionable){i.on("init",function(){var m=i.getBody();var l=function(){var o=i.selection.getSel();var p=o?f(o.anchorNode):null;if(p&&(p.parents("pre").length>0||p.parents("div.panelHeader,panel-title").length>0)){return true}};var k=j.jiramentions.issuekey;var n=j.jiramentions.projectkey;f(m).attr("data-issuekey",k);f(m).attr("data-projectkey",n);if(!m._controller){m._controller=new b(k,i,l)}m._controller.textarea(m);c(i,m._controller)})}}});e.PluginManager.add("jira.jiramentions",e.plugins.jira.JiraMentions);e.PluginManager.urls["jira.jiramentions"]=true;return{configure:function(i,j){j.plugins.push("jira.jiramentions");var k=i.element.$textarea.data();j.jiramentions={issuekey:k.issuekey,projectkey:k.projectkey,mentionable:i.element.$textarea.hasClass("mentionable")}}}});;