;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:schema-builder', location = 'js/editor-schema-builder.js' */
define("jira/editor/schema-builder",["jira/editor/tinymce","jquery","underscore","jira/util/logger"],function(n,b,m,o){var e=function(){this.noBreak=[];this.noNest=[];this.customElementChildren={};this.customElementAttrs={};this.validChildren=[];this.unwantedAttributes=[];this.extendedValidElements=[];this.baseSchema="html5";this.validElements=[]};e.prototype.withCustomElement=function(r,s,q){if(!f(r)){o.error("Could not add custom element: incorrect `name` given:",r,"(see https://www.w3.org/TR/custom-elements/#valid-custom-element-name)");return this}if(!c(s)){o.error("Could not add custom element: incorrect `children` given:",s);return this}if(!g(q)){o.error("Could not add custom element: incorrect `attributes` given:",q);return this}if(false===s){s=[]}else{if(undefined===s){s=["p","#comment"]}else{s.push("#comment")}}if(!q){q=[]}this.customElementChildren[r]=m.uniq(s);this.customElementAttrs[r]=m.uniq(q);return this};e.prototype.withBaseSchema=function i(q){this.baseSchema=q;return this};e.prototype.withValidElements=function l(q){this.validElements=q;return this};e.prototype.withNoBreak=function p(q){this.noBreak.push.apply(this.noBreak,q);return this};e.prototype.withNoSelfNest=function h(q){this.noNest.push.apply(this.noNest,q.map(function(r){return[r,r]}));return this};e.prototype.setValidChildren=function d(r,q){this.validChildren.push(r+"["+q+"]");return this};e.prototype.withExtendedValidElements=function(q){this.extendedValidElements.push.apply(this.extendedValidElements,q);return this};e.prototype.withNoNest=function h(q){this.noNest.push.apply(this.noNest,q);return this};e.prototype.withUnwantedAttributes=function j(q){this.unwantedAttributes.push.apply(this.unwantedAttributes,q);return this};e.prototype.build=function k(){var A=this.baseSchema;var r=[];var s=[];var q=[];var t=[];var y={};this.noBreak.forEach(function(C){v(C)});this.noNest.forEach(function(C){u.apply(null,C)});r.push.apply(r,Object.keys(this.customElementChildren));b.each(this.customElementChildren,function(C,D){y[C]=D.reduce(function(E,F){E[F]={};return E},{})});s.push.apply(s,this.validChildren);q=a(this.validElements,this.unwantedAttributes,A);t.push.apply(t,m.map(this.customElementAttrs,function(D,C){return C+(D.length?"["+D.join("|")+"]":"")}));t.push.apply(t,this.extendedValidElements);return{getValidChildren:function x(){return s.join(",")},getValidElements:function B(){return q.join(",")},getExtendedValidElements:function z(){return t.join(",")},getCustomElements:function(){return r.join(",")},getType:function w(){return A},fixChildren:function(C){b.extend((C||{}).children,y)}};function u(C,D){s.push("-"+C+"["+D+"]")}function v(C){u(C,"br")}};return e;function a(t,r,s){var u=new n.html.Schema({schema:s});var q=u.elements;q.img.attributesRequired=["src"];q.img.attributes.imagetext={};q.img.attributesOrder.push("imagetext");return t.map(function(x){var w=q[x];if(!w){return false}var z=(w.removeEmptyAttrs)?"!":"";var y="";if(w.paddEmpty){y="#"}else{if(w.removeEmpty){y="-"}}var v=w.attributesOrder.map(function(A){var B="";if((w.attributesRequired||[]).indexOf(A)!==-1){B="!"}return B+A}).filter(function(A){return r.indexOf(A)===-1});return y+x+z+"["+v.join("|")+"]"}).filter(function(v){return !!v})}function f(q){return typeof q==="string"&&q.indexOf("-")>0}function c(q){if(m.isArray(q)){return m.every(q,function(r){return typeof r==="string"})}return false===q||undefined===q}function g(q){if(m.isArray(q)){return m.every(q,function(r){return typeof r==="string"})}return undefined===q}});;
;
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:schema-builder', location = 'js/editor-supported-operations.js' */
define("jira/richeditor/editor-supported-operations",["underscore"],function(b){var g=["bold","italic","underline","bullet-list","numbered-list","h1","h2","h3","h4","h5","h6","paragraph","paragraph-quote","block-quote","monospace","delete","superscript","subscript","cite","hr","color","icon","attachment","code","panel","noformat","table","undo","redo"];var f=["br","span","a","p","div"];var a=d(g,f);return{getWikiOperations:function c(){return g},getRequiredHtmlTags:function e(){return a},mapWikiOperationToHtmlTags:d};function d(j,h){var l={bold:["strong","b"],italic:["em","i"],underline:["ins","u"],"bullet-list":["li","ul"],"numbered-list":["li","ol"],paragraph:[],"paragraph-quote":["blockquote"],"block-quote":["blockquote"],monospace:["samp","tt","code"],"delete":["del"],superscript:["sup"],subscript:["sub"],color:["font"],icon:["img"],attachment:["a","img","sup"],code:["pre"],panel:["b"],noformat:["pre"],table:["table","thead","tbody","tr","th","td","tfoot","caption","colgroup","col"],undo:[],redo:[]};var k=b.map(j,function(m){return l[m]||[m]});k.push(h||[]);var i=b.flatten(k);return b.uniq(i)}});;