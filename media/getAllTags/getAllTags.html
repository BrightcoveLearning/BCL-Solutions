<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Get all tags</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">
        <meta name="author" content="">
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="/bcls/bootstrap/js/html5shiv.js"></script>
        <![endif]-->
        <!-- Fav and touch icons -->
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/bcls/bootstrap/img/apple-touch-icon-144-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/bcls/bootstrap/img/apple-touch-icon-114-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/bcls/bootstrap/img/apple-touch-icon-72-precomposed.png">
        <link rel="apple-touch-icon-precomposed" href="/bcls/bootstrap/img/apple-touch-icon-57-precomposed.png">
        <link rel="shortcut icon" href="/bcls/bootstrap/img/favicon.ico">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/styles/github.css">
        <link href="//docs.brightcove.com/en/scripts/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css">
        <script src="//use.edgefonts.net/source-code-pro.js"></script>
        <link rel="stylesheet" type="text/css" href="//docs.brightcove.com/en/styles/bcls-doc-site.css">
        <style>
            /* element styles */
            body {
                font-family: "Helvetica Neue", Arial, Helvetica, sans-serif;
                width: 80%;
                padding-left: 40px;
                padding-top: 100px;
            }
            fieldset {
                width: 800px;
                display: block;
                margin-bottom: 20px;
                border-radius: 5px;
            }
            h1 {
                border-bottom: 1px #CCC solid;
            }
            input {
                width: 400px;
            }
            pre, textarea {
                border: 1px #999 solid;
                border-radius: 5px;
                padding: 5px;
                width: 100%;
                height: 800px;
            }
            /* class styles */
            .button {
                background-color: #f5f5f5;
                border: 1px #666 solid;
                border-radius: 5px;
                cursor: pointer;
                font-size: small;
                margin-left: 20px;
                padding: 5px;
            }
            .run-button {
                color: #f5f5f5;
                background-color: #666666;
                border: 1px #000000 solid;
                border-radius: 5px;
                cursor: pointer;
                font-size: small;
                margin-left: 20px;
                padding: 5px;
            }
            .text-warning {
                color: #990000;
                background-color: #f5f5f5;
                border: 1px #990000 solid;
                border-radius: 5px;
                padding: 5px;
            }
        </style>
    </head>

    <body data-spy="scroll" data-target=".sub-menu" data-offset="100">
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span12">
                    <!-- header navbar -->
                    <div id="titleBar" class="navbar-inverse navbar-fixed-top">
                        <div class="navbar-inner">
                            <div id="otherSites">
                                <ul class="nav pull-right small">
                                    <li>
                                        <a href="//brightcove.com">BRIGHTCOVE.COM</a>
                                    </li>
                                    <li>
                                        <a href="//support.brightcove.com">SUPPORT</a>
                                    </li>
                                    <li>
                                        <a href="//support.brightcove.com/video-cloud/training-videos">TRAINING VIDEOS</a>
                                    </li>
                                </ul>
                            </div>
                            <a class="brand" href="//docs.brightcove.com/en/index.html">BRIGHTCOVE DEVELOPER DOCUMENTATION</a>
                        </div>
                    </div>
                    <!-- end header navbar -->
                    <!-- nav navbar -->
                    <div id="navBar" class="navbar-inverse navbar-fixed-top">
                        <div class="navbar-inner">
                            <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
                            <a class="btn btn-navbar pull-right" data-toggle="collapse" data-target=".nav-collapse">
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                            </a>
                            <!-- Everything you want hidden at 940px or less, place within here -->
                            <ul id="sectionNav" class="nav"></ul>
                        </div>
                    </div>
                    <!-- end nav navbar -->
                </div>
            </div>
        </div>
        <!-- main content starts here -->
        <h1>Get All Tags For Your Media Library</h1>
        <p>This app examines the tags for all active videos in your Video Cloud libary and constructs a list of all tags that are used.</p>
        <p class="text-warning">Note that app will retrieve <em>all</em> active videos in your account &mdash; if you have a large number of videos, that could take quite awhile.</p>
        <p>Enter a Read API token for your account:</p>
        <p><input id="BCLtoken" type="text" name="BCLtoken" size="100" value="WDGO_XdKqXVJRVGtrNuGLxCYDNoR-SvA5yUqX2eE6KjgefOxRzQilw.." /></p>
        <p><button id="runButton">Go</button></p>
    <fieldset>
      <legend>Tags</legend>
            <div id="results"></div>
    </fieldset>
        <!-- scripts -->
        <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-smooth-scroll/1.4.12/jquery.smooth-scroll.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/1.1.2/handlebars.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.0/highlight.min.js"></script>

        <script src="//docs.brightcove.com/en/scripts/docs-nav-data.min.js"></script>
        <script src="//docs.brightcove.com/en/scripts/bcls-doc-site.js"></script>
        <script type="text/javascript" src="//docs.brightcove.com/en/scripts/bc-mapi.js"></script>
        <script type="text/javascript" src="//docs.brightcove.com/en/scripts/secondsToTime.js"></script>
        <script>
            // namespace to keep all the "global" vars together
            var BCL = {};
            BCL.tagArray = [];
            BCL.token = document.getElementById("BCLtoken").value;
            BCL.pageNumber = 0;
            BCL.totalCalls = 0;
            BCL.pageSize = 100;
            BCL.callNumber = 1;
            BCL.getItemCount = true;
            BCL.results = document.getElementById("results");
            document.getElementById("runButton").addEventListener("click", function () {
                    BCL.token = document.getElementById("BCLtoken").value;
                    BCL.runQuery();
            })
            BCL.runQuery = function() {
                // console.log("call number: " + BCL.callNumber);
                // console.log("page number: " + BCL.pageNumber);
                BCMAPI.token = BCL.token;
                BCMAPI.callback = "BCL.onSearchResponse";
                BCL.params = {};
                BCL.params.page_size = BCL.pageSize;
                BCL.params.page_number = BCL.pageNumber;
                BCL.params.get_item_count = BCL.getItemCount;
                BCL.params.video_fields = "tags";
                BCMAPI.search(BCL.params);
            }
            BCL.onSearchResponse = function(jsonData) {
                // console.log(jsonData);
                BCL.tagArray = jsonData["items"][0].tags;
                for (var i = 1; i < jsonData["items"].length; i++) {
                    BCL.tagArray.push.apply(BCL.tagArray, jsonData["items"][i].tags);
                    BCL.tagArray = BCL.removeDuplicateElements(BCL.tagArray);
                }
                for (var j = 0; j < BCL.tagArray.length; j++) {
                    BCL.results.innerHTML += BCL.tagArray[j] + "<br />";
                }
                // handle call looping
                if (BCL.callNumber === 1) {
                    BCL.getItemCount = false;
                    BCL.totalCalls = Math.ceil(jsonData.total_count / BCL.pageSize);
                    // console.log("total calls: " + BCL.totalCalls);
                }
                BCL.callNumber++;
                BCL.pageNumber++;
                if (BCL.callNumber <= BCL.totalCalls) {
                    BCL.runQuery();
                }

            }
            BCL.removeDuplicateElements = function(arrayName)
              {
              var newArray=new Array();
              label:for(var i=0; i<arrayName.length;i++ )
              {
              for(var j=0; j<newArray.length;j++ )
              {
              if(newArray[j]==arrayName[i])
              continue label;
              }
              newArray[newArray.length] = arrayName[i];
              }
              return newArray;
              }
        </script>
    </body>
</html>