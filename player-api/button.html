<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title></title>
        <style>

        </style>
    </head>
    <body>

        <script src="button.js"></script>
        <script src="component.js"></script>
        <script>
            var BCLSVJS = ( function (window, document, class_data, parent_class_data) {
                "use strict";
                var title = document.getElementsByTagName('title')[0],
                    // path as an array
                    path = document.location.pathname.split("/"),
                    // data structures
                    /* the following should be the only line that changes
                        current class first, parent class(es) after */
                    classes = {thisClass: class_data, parentClass: parent_class_data},
                    doc_class,
                    doc_parent_class,
                    doc_data = {},
                    // elements
                    main,
                    doc_body = document.getElementsByTagName("body")[0],
                    // functions
                    isDefined,
                    copyObj,
                    findObjectInArray,
                    findObjectsInArray,
                    getSubArray,
                    getPropertyArrays,
                    sortArray,
                    createEl,
                    bclslog,
                    addHeaderContent,
                    addIndex,
                    addMembersContent,
                    init;
                /**
                 * Logging function - safe for IE
                 * @param  {string} context - description of the data
                 * @param  {*} message - the data to be logged by the console
                 * @return {}
                 */
                bclslog = function (context, message) {
                    if (window["console"] && console["log"]) {
                        console.log(context, message);
                    }
                    return;
                };
                /**
                 * tests for all the ways a variable might be undefined or not have a value
                 * @param {*} x the variable to test
                 * @return {Boolean} true if variable is defined and has a value
                 */
                isDefined = function (x) {
                    if ( x !== "" && x !== null && x !== undefined && x !== NaN){
                        return true;
                    } else {
                        return false;
                    }
                };
                /**
                 * get a copy of (rather than reference to) an object
                 * @param  {object} obj - the object you want a copy
                 * @return {object}     the copy
                 */
                copyObj = function (obj) {
                    return JSON.parse(JSON.stringify(obj));
                };
                /**
                 * find index of an object in array of objects
                 * based on some property value
                 * generally useful for finding a unique object
                 *
                 * @param {array} targetArray - array to search
                 * @param {string} objProperty - object property to search
                 * @param {string|number} value - value of the property to search for
                 * @return {integer} index of first instance if found, otherwise returns -1
                 */
                findObjectInArray = function (targetArray, objProperty, value) {
                    var i, totalItems = targetArray.length, objFound = false;
                    for (i = 0; i < totalItems; i++) {
                        if (targetArray[i][objProperty] === value) {
                            objFound = true;
                            return i;
                        }
                    }
                    if (objFound === false) {
                        return -1;
                    }
                };
                /**
                 * find indexes of a set of object in array of objects
                 * based on some property value
                 * generally useful for finding several objects
                 *
                 * @param {array} targetArray - array to search
                 * @param {string} objProperty - object property to search
                 * @param {string|number} value - value of the property to search for
                 * @return {array} array of indexes for matching objects
                 */
                findObjectsInArray = function (targetArray, objProperty, value) {
                    var i, totalItems = targetArray.length, newArr = [];
                    for (i = 0; i < totalItems; i++) {
                        if (targetArray[i][objProperty] === value) {
                            newArr.push(i);
                        }
                    }
                    return newArr;
                };
                /**
                 * get a subset of objects in array of objects
                 * based on some property value
                 *
                 * @param {array} targetArray - array to search
                 * @param {string} objProperty - object property to search
                 * @param {string|number} value - value of the property to search for
                 * @return {array} array of objects with matching property value
                 */
                getSubArray = function (targetArray, objProperty, value) {
                    var i, totalItems = targetArray.length, objFound = false, idxArr = [];
                    for (i = 0; i < totalItems; i++) {
                        if (targetArray[i][objProperty] === value) {
                            objFound = true;
                            idxArr.push(targetArray[i]);
                        }
                    }
                    return idxArr;
                };
                /**
                 * sort an array of objects based on an object property
                 * @param {array} targetArray - array to sort
                 * @param {string} objProperty - property whose value to sort on
                 * @return {array} the sorted array
                 */
                sortArray = function (targetArray, objProperty) {
                    targetArray.sort(function (a, b) {
                        var propA = a[objProperty].toLowerCase(), propB = b[objProperty].toLowerCase();
                        // sort ascending; reverse propA and propB to sort descending
                        if (propA < propB) {
                             return -1;
                        } else if (propA > propB) {
                             return 1;
                        } else {
                             return 0;
                        }
                    });
                    return targetArray;
                };
                /**
                 * create an element
                 * @param  {string} type - the element type
                 * @param  {object} attributes - attributes to add to the element
                 * @return {object} the HTML element
                 */
                createEl = function (type, attributes) {
                    var el;
                    if (isDefined(type)) {
                        el = document.createElement(type);
                        if (isDefined(attributes)) {
                            var attr;
                            for (attr in attributes) {
                                el.setAttribute(attr, attributes[attr]);
                            }
                        }
                        return el;
                    }
                };
                /**
                 * extracts the events, methods, and properties for the classes
                 * @param {object} classes - object whose properties are classes with values of the data for that class
                 * @return {}
                 */
                getPropertyArrays = function (classes) {
                    var i, iMax, currentClass, classData = [], classIdx, j, jMax, itemIdx, privateItems = [];
                    if (isDefined(classes)) {
                        iMax = classes.length;
                        for (currentClass in classes) {
                            classData = classes[currentClass];
                            privateItems = [];
                            // get the class data for the page heading
                            classIdx = findObjectInArray(classData, "kind", "class");
                            doc_data[currentClass].headerInfo = copyObj(classData[classIdx]);
                            // remove all private items
                            privateItems = findObjectsInArray(classData, "access", "private");
                            bclslog("privateItems", privateItems);
                            j = privateItems.length;
                            do {
                                classData.splice(privateItems[j--], 1);
                            } while (j > 0);
                            // get the methods data
                            doc_data[currentClass].methodsArray = getSubArray(classData, "kind", "function");
                            // get the events data
                            doc_data[currentClass].eventsArray = getSubArray(classData, "kind", "event");
                            // get the properties
                            doc_data[currentClass].propertiesArray = getSubArray(classData, "kind", "property");
                            bclslog(currentClass, doc_data[currentClass]);
                        }
                    }
                };
                /**
                 * add the class header content
                 */
                addHeaderContent = function () {
                    var mainContent = createEl("div", {id:"main", class: "section"}),
                        topSection = createEl("section", {id:"top"}),
                        topSectionEl,
                        header = createEl("h1", {id:doc_data.thisClass.headerInfo.name}),
                        headerEl;
                    // add elements
                    topSection.appendChild(header);
                    mainContent.appendChild(topSection);
                    doc_body.appendChild(mainContent);
                    main = document.getElementById("main");
                    topSectionEl = document.getElementById("top");
                    headerEl = document.getElementById(doc_data.thisClass.headerInfo.name);
                    // add content
                    // page header
                    headerEl.textContent = doc_data.thisClass.headerInfo.name;
                    // other stuff
                    if (isDefined(doc_data.parentClass.headerInfo)) {
                        topSectionEl.innerHTML += "<p><strong>EXTENDS</strong>: <a href=\"" + doc_data.parentClass.headerInfo.meta.filename + "\">" + doc_data.parentClass.headerInfo.meta.filename + "</a></p>";
                    }
                    topSectionEl.innerHTML += "<p><strong>DEFINED IN</strong>: <a href=\"" + doc_data.thisClass.headerInfo.meta.filename + "\">src/" + doc_data.thisClass.headerInfo.meta.filename + " Line number: " + doc_data.thisClass.headerInfo.meta.lineno + "</a></p>";
                    topSectionEl.innerHTML += doc_data.thisClass.headerInfo.description;
                };
                /**
                 * add the side nav
                 */
                addIndex = function () {
                    var section = createEl("section", {id: "index", class: "section"}),
                        sectionHeader = createEl("h2"),
                        memberIndex = createEl("div", {id: "memberIndex"}),
                        methodsHeader,
                        eventsHeader,
                        propertieHeader,
                        methodsList,
                        propertiesList,
                        eventsList,
                        item,
                        listItem,
                        listLink,
                        em,
                        text,
                        i,
                        iMax,
                        makeList = function (classArr, parentArr, member, header, list) {
                            if (classArr.length > 0 || isDefined(doc_data.parentClass) && parentArr.length > 0) {
                                header = createEl("h3", {id: header});
                                text = document.createTextNode(member);
                                header.appendChild(text);
                                list = createEl("ul", {id: list});
                                iMax = classArr.length;
                                for (i = 0; i < iMax; i++) {
                                    item = classArr[i].name;
                                    listItem = createEl("li");
                                    listLink = createEl("a", {href: "#" + item});
                                    text = document.createTextNode(item);
                                    listLink.appendChild(text);
                                    listItem.appendChild(listLink);
                                    list.appendChild(listItem);
                                }
                                if (isDefined(doc_data.parentClass) && parentArr.length > 0) {
                                iMax = parentArr.length;
                                    for (i = 0; i < iMax; i++) {
                                        item = parentArr[i].name;
                                        listItem = createEl("li");
                                        listLink = createEl("a", {href: "#" + item});
                                        listItem.appendChild(listLink);
                                        text = document.createTextNode(item + " ");
                                        listLink.appendChild(text);
                                        em = createEl("em");
                                        text = document.createTextNode("inherited");
                                        em.appendChild(text);
                                        listItem.appendChild(em);
                                        list.appendChild(listItem);
                                    }
                                }
                                memberIndex.appendChild(header);
                                memberIndex.appendChild(list);
                            }
                        };
                    text = document.createTextNode("Index");
                    sectionHeader.appendChild(text);
                    makeList(doc_data.thisClass.propertiesArray, doc_data.parentClass.propertiesArray, "Properties", "propertiesHeader", "propertiesList");
                    makeList(doc_data.thisClass.methodsArray, doc_data.parentClass.methodsArray, "Methods", "methodsHeader", "methodsList");
                    makeList(doc_data.thisClass.eventsArray, doc_data.parentClass.eventsArray, "Events", "eventsHeader", "eventsList");
                    section.appendChild(sectionHeader);
                    section.appendChild(memberIndex);
                    main.appendChild(section);
                };
                /**
                 * add the member content
                 */
                addMembersContent = function () {
                    var members = ["Properties", "Methods", "Events"],
                        section,
                        header,
                        item,
                        itemHeader,
                        itemDescription,
                        itemEl,
                        text,
                        i,
                        iMax,
                        j,
                        jMax;
                };
                /**
                 * add the events
                 */
                addEventsContent = function () {

                };
                /**
                 * add the properties
                 */
                addPropertiesContent = function () {

                };
                /**
                 * init gets things going
                 */
                init = function () {
                    var className, fileName;
                    // get the class name from the file name
                    fileName = path[path.length - 1];
                    doc_class = fileName.substring(0, fileName.indexOf("."));
                    // data structures
                    for (className in classes) {
                        doc_data[className] = {};
                        doc_data[className].headerInfo = {};
                        doc_data[className].methodsArray = [];
                        doc_data[className].eventsArray = [];
                        doc_data[className].propertiesArray = [];
                    }
                    // get the class prop arrays
                    getPropertyArrays(classes);
                    addHeaderContent();
                    addIndex();
                    addPropertiesContent();
                    addMethodsContent();
                    addEventsContent();
                };
                bclslog("class_data", class_data);
                bclslog("parent_class_data", parent_class_data);
                init();
                return {

                };
            })(window, document, class_data, parent_class_data);
        </script>
    </body>
</html>
