"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(a,b){function c(a){var b,c,d;for(c=1;c<arguments.length;c++){b=arguments[c];for(d in b)b.hasOwnProperty(d)&&(a[d]=b[d])}return a}var d={CHAPTER_THUMBNAILS_MENU:{CLASS_NAME:"vjs-chapter-thumbnails-menu",ID:"vjs_chapter_thumbnails_menu",NAME:"ChapterThumbnailsMenu"},CHAPTER_THUMBNAILS_MENU_BUTTON:{CLASS_NAME:"vjs-chapter-thumbnails-button vjs-chapters-button",NAME:"ChapterThumbnailsMenuButton",TEXT:"Chapters"},CHAPTER_THUMBNAILS_MENU_ITEM:{CLASS_NAME:"vjs-chapter-thumbnails-menu-item",NAME:"ChapterThumbnailsMenuItem"},CHAPTER_THUMBNAILS_TRACK:{ID:"chapter_thumbnails_track",KIND:"metadata",LABEL:"English",LANGUAGE:"en"},CONTROL_BAR:"controlBar"},e=function(){function e(a){var c=arguments.length<=1||arguments[1]===b?{}:arguments[1];_classCallCheck(this,e),this.options=c,this.player=a,this.removeTextTrackFromPlayer(),this.removeComponentFromPlayer();var d=this.addTextTrackToPlayer();this.addComponentToPlayer(d)}return _createClass(e,[{key:"addComponentToPlayer",value:function(a){var b=this.player.getChild(d.CONTROL_BAR);b.addChild(d.CHAPTER_THUMBNAILS_MENU_BUTTON.NAME,{text_track:a})}},{key:"addTextTrackToPlayer",value:function(){var a=c({label:d.CHAPTER_THUMBNAILS_TRACK.LABEL,language:d.CHAPTER_THUMBNAILS_TRACK.LANGUAGE},this.options);return a.id=d.CHAPTER_THUMBNAILS_TRACK.ID,a.kind=d.CHAPTER_THUMBNAILS_TRACK.KIND,this.player.addRemoteTextTrack(a)}},{key:"removeComponentFromPlayer",value:function(){var a=this.player.getChild(d.CONTROL_BAR),c=a.getChild(d.CHAPTER_THUMBNAILS_MENU_BUTTON.NAME);c!==b&&(c.dispose(),a.removeChild(d.CHAPTER_THUMBNAILS_MENU_BUTTON.NAME))}},{key:"removeTextTrackFromPlayer",value:function(){var a=this.player.textTracks().getTrackById(d.CHAPTER_THUMBNAILS_TRACK.ID);a!==b&&this.player.removeRemoteTextTrack(a)}}],[{key:"defineMenu",value:function(){a.ChapterThumbnailsMenu=a.Menu.extend({init:function(b,c){a.Menu.call(this,b,c),this.el().id=d.CHAPTER_THUMBNAILS_MENU.ID,this.addClass(d.CHAPTER_THUMBNAILS_MENU.CLASS_NAME)}})}},{key:"defineMenuButton",value:function(){a.ChapterThumbnailsMenuButton=a.MenuButton.extend({init:function(b,c){a.MenuButton.call(this,b,c),this.el().setAttribute("aria-label","Chapters Menu")},buttonText:d.CHAPTER_THUMBNAILS_MENU_BUTTON.TEXT,className:d.CHAPTER_THUMBNAILS_MENU_BUTTON.CLASS_NAME,createMenu:function(){this.menu===b&&(this.menu=new a.ChapterThumbnailsMenu(this.player())),this.menu_items=[];var c=this.player().textTracks().getTrackById(d.CHAPTER_THUMBNAILS_TRACK.ID);return document.getElementById(d.CHAPTER_THUMBNAILS_TRACK.ID).addEventListener("load",function(b){for(var d=0,e=c.cues.length;e>d;d++){var f=c.cues[d],g=new a.ChapterThumbnailsMenuItem(this.player(),{cue:f,text_track:c});this.menu_items.push(g),this.menu.addChild(g)}this.menu_items.length>0&&this.show(),this.player().addChild(this.menu)}.bind(this),!1),this.menu},onClick:function(a){this.menu.hasClass("vjs-lock-showing")?this.menu.unlockShowing():this.menu.lockShowing(),this.player().el().focus()}})}},{key:"defineMenuItem",value:function(){a.ChapterThumbnailsMenuItem=a.MenuItem.extend({init:function(b,c){var e=c.cue,f=b.currentTime(),g=c.text_track,h=JSON.parse(e.text);c.label=a.createEl("div",{className:"vjs-chapters-thumbnails-item",innerHTML:['<img class="vjs-chapters-thumbnails-item-image" src="'+h.image+'" />','<span class="vjs-chapters-thumbnails-item-title">'+h.title+"</span>"].join("")}).outerHTML,c.select=e.startTime<=f&&f<e.endTime,a.MenuItem.call(this,b,c),this.addClass(d.CHAPTER_THUMBNAILS_MENU_ITEM.CLASS_NAME),g.addEventListener("cuechange",a.bind(this,this.onCueChange))},onClick:function(a){var b=this.options().cue;this.player().currentTime(b.startTime),this.player().el().focus()},onCueChange:function(a){this.update()},update:function(){var a=this.options().cue,b=this.player().currentTime();this.selected(a.startTime<=b&&b<a.endTime)}})}}]),e}();e.defineMenu(),e.defineMenuButton(),e.defineMenuItem(),a.plugin("chapter_thumbnails",function(a){new e(this,a)})}(window.videojs,void 0);